{"version":3,"sources":["routers.js","panels/Home.js","api/api.js","panels/Auth.js","modals/CardError.js","modals/CardDatabase.js","App.js","index.js"],"names":["routes","Page","router","Router","onEnterPage","console","log","on","nextRote","oldRoute","getPageId","getParams","getPanelId","getViewId","getLocation","isModal","isPopup","hasOverlay","start","Home","id","dataOrders","useRouter","useState","data","setData","additionalFields","setAdditionalFields","addssFields","setAddssFields","autoCam","setAutoCam","cityOptions","setCityOptions","streetOptions","setStreetOptions","houseOptions","setHouseOptions","apartmentOptions","setApartmentOptions","cityValue","setCityValue","streetValue","setStreetValue","houseValue","setHouseValue","apartmentValue","setApartmentValue","apartmentItem","setApartmentItem","valMeterValue","setValMeterValue","setActivePhoto","setModeSendBtn","valMeterRef","useRef","photoRef","useEffect","length","cityVariables","Set","map","x","city","label","value","toggleApartment","item","apartment","setTimeout","current","click","onClick","pushModal","after","height","top","placeholder","searchable","options","onChange","e","target","streetsOfCity","filter","streetVariables","street","disabled","housesOfCity","housesVariables","house","showArrows","getScrollToLeft","i","getScrollToRight","mode","style","display","className","key","selected","apartmentsOfCity","toggleHouse","transferred","color","getRef","before","controlSize","stretched","accept","capture","files","reader","FileReader","addEventListener","result","focus","readAsDataURL","type","width","marginRight","newData","forEach","element","push","size","checked","Array","keys","toString","aria-label","Date","toLocaleDateString","getOrders","a","fetch","API_URL","method","body","JSON","stringify","then","res","json","catch","status","message","Auth","setModalErrorText","login","setLogin","password","setPassword","CardError","modalErrorText","onClose","popPage","header","subheader","CardDatabase","countDownload","waitDownload","loadOrders","icon","margin","App","location","useLocation","React","popout","setPopout","setDataOrders","setCountDownload","setWaitDownload","loadCachesData","hasData","offset","count","orders","jsonResponse","Response","headers","caches","open","cache","put","match","r","modal","activeModal","getModalId","webviewType","WebviewType","INTERNAL","justifyContent","maxWidth","spaced","window","innerWidth","onSwipeBack","history","getViewHistory","activePanel","getViewActivePanel","ReactDOM","render","Provider","document","getElementById"],"mappings":"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","file":"static/js/main.a0e1a555.chunk.js","sourcesContent":["import { Page, Router } from '@happysanta/router';\r\n\r\nexport const PAGE_MAIN = '/';\r\nexport const PAGE_AUTH = '/auth';\r\n\r\nexport const PANEL_MAIN = 'panel_main';\r\nexport const PANEL_AUTH = 'panel_auth';\r\n\r\nexport const VIEW_MAIN = 'view_main';\r\n\r\nexport const MODAL_CARD = 'modal_card';\r\nexport const MODAL_PAGE = 'modal_page';\r\nexport const MODAL_ERROR = 'modal_error';\r\nexport const MODAL_DATABASE = 'modal_database';\r\n\r\nexport const POPOUT_CONFIRM = 'popout_confirm';\r\n\r\nconst routes = {\r\n\t[PAGE_MAIN]: new Page(PANEL_MAIN, VIEW_MAIN),\r\n\t[PAGE_AUTH]: new Page(PANEL_AUTH, VIEW_MAIN),\r\n};\r\n\r\nexport const router = new Router(routes);\r\n\r\nrouter.onEnterPage(PAGE_MAIN, () => {\r\n\tconsole.log('переход на главную страницу');\r\n});\r\n\r\nrouter.on('update', (nextRote, oldRoute) => {\r\n\tnextRote.getPageId() // /product/:id([0-9]+)\r\n\tnextRote.getParams() // { id: \"12\" }\r\n\tnextRote.getPanelId() // panel_product\r\n\tnextRote.getViewId() // view_main\r\n\tnextRote.getLocation() // /product/12\r\n\tnextRote.isModal() // false\r\n\tnextRote.isPopup() // false\r\n\tnextRote.hasOverlay() // false\r\n\r\n\tif (oldRoute) {\r\n\t\tconsole.log(`move from page ${oldRoute.getLocation()} -> ${nextRote.getLocation()}`);\r\n\t} else {\r\n\t\tconsole.log(`enter to page ${nextRote.getLocation()}`);\r\n\t}\r\n});\r\n\r\nrouter.start();\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Panel, PanelHeader, Button, Group, Tabs, TabsItem, Cell, FormItem, File, CellButton, Input, Switch, HorizontalScroll, Select, Checkbox, Div, PanelHeaderButton, FormStatus, WriteBar, WriteBarIcon, Card } from '@vkontakte/vkui';\r\n\r\nimport { Icon12Verified, Icon24Camera, Icon24ChevronDown, Icon24ChevronUp, Icon28HelpCircleOutline, Icon28SmileOutline, Icon56AddCircleOutline } from '@vkontakte/icons';\r\nimport AnimateHeight from 'react-animate-height';\r\nimport { useRouter } from '@happysanta/router';\r\nimport { MODAL_DATABASE } from '../routers';\r\n// import CropImg from '../components/CropImg'\r\n// import Webcam from 'react-webcam';\r\n\r\nlet tempData = [{\r\n\tid: 1,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Чернышевского\",\r\n\thouse: \"22\",\r\n\tapartment: \"1\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 2,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Чернышевского\",\r\n\thouse: \"22\",\r\n\tapartment: \"2\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 3,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Чернышевского\",\r\n\thouse: \"22\",\r\n\tapartment: \"3\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 4,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"1\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 5,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"2\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 5,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"3\",\r\n\tapartment: \"3\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 6,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"3\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 7,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"4\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 8,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"5\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 9,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"6\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 10,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"7\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n}, {\r\n\tid: 11,\r\n\tcity: \"Воронеж\",\r\n\tstreet: \"Победы\",\r\n\thouse: \"2\",\r\n\tapartment: \"8\",\r\n\ttransferred: false,\r\n\tsaved: false,\r\n},]\r\n\r\nconst Home = ({ id, dataOrders }) => {\r\n\tconst router = useRouter();\r\n\r\n\tconst [data, setData] = useState([])\r\n\r\n\tconst [additionalFields, setAdditionalFields] = useState(false)\r\n\tconst [addssFields, setAddssFields] = useState(true)\r\n\tconst [previewFields, setPreviewFields] = useState(true)\r\n\tconst [autoCam, setAutoCam] = useState(true)\r\n\r\n\tconst [cityOptions, setCityOptions] = useState([])\r\n\tconst [streetOptions, setStreetOptions] = useState([])\r\n\tconst [houseOptions, setHouseOptions] = useState([])\r\n\tconst [apartmentOptions, setApartmentOptions] = useState([])\r\n\r\n\tconst [cityValue, setCityValue] = useState('')\r\n\tconst [streetValue, setStreetValue] = useState('')\r\n\tconst [houseValue, setHouseValue] = useState('')\r\n\tconst [apartmentValue, setApartmentValue] = useState('')\r\n\tconst [apartmentItem, setApartmentItem] = useState(null)\r\n\r\n\tconst [valMeterValue, setValMeterValue] = useState('')\r\n\tconst [activePhoto, setActivePhoto] = useState(null)\r\n\t// const [activePhotoCrop, setActivePhotoCrop] = useState(null)\r\n\r\n\tconst [modeSendBtn, setModeSendBtn] = useState('send')\r\n\r\n\t// const webcamRef = useRef(null);\r\n\t// const [imgSrc, setImgSrc] = useState(null);\r\n\tconst valMeterRef = useRef(null);\r\n\tconst photoRef = useRef(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tconsole.log('update dataOrders')\r\n\t\tsetData(dataOrders)\r\n\t\tif (dataOrders.length > 0) {\r\n\t\t\tlet cityVariables = [...new Set(dataOrders.map(x => x.city))]\r\n\t\t\tsetCityOptions(cityVariables.map(x => { return { label: x, value: x } }))\r\n\t\t}\r\n\t}, [dataOrders]);\r\n\r\n\t// const capture = useCallback(() => {\r\n\t// \tconst imageSrc = webcamRef.current.getScreenshot();\r\n\t// \tsetImgSrc(imageSrc);\r\n\t// }, [webcamRef, setImgSrc]);\r\n\r\n\tconst changeFile = (e) => {\r\n\t\tconsole.log(e.target.files)\r\n\t\tif (e.target.files && e.target.files.length > 0) {\r\n\t\t\tconst reader = new FileReader();\r\n\t\t\treader.addEventListener('load', () => {\r\n\t\t\t\tsetActivePhoto(reader.result)\r\n\t\t\t\tif (valMeterRef && valMeterRef.current)\r\n\t\t\t\t\tsetTimeout(() => valMeterRef.current.focus(), 200)\r\n\r\n\t\t\t}\r\n\t\t\t);\r\n\t\t\treader.readAsDataURL(e.target.files[0]);\r\n\t\t}\r\n\t}\r\n\r\n\tconst toggleCity = (e) => {\r\n\t\tlet city = e.target.value\r\n\t\tlet streetsOfCity = data.filter(x => x.city === city)\r\n\t\tlet streetVariables = [...new Set(streetsOfCity.map(x => x.street))]\r\n\t\tsetStreetOptions(streetVariables.map(x => { return { label: x, value: x } }))\r\n\t\tsetCityValue(city)\r\n\t\tsetStreetValue('')\r\n\t\tsetHouseValue('')\r\n\t\tsetApartmentValue('')\r\n\t}\r\n\r\n\tconst toggleStreet = (e) => {\r\n\t\tlet street = e.target.value\r\n\t\tlet housesOfCity = data.filter(x => x.city === cityValue && x.street === street)\r\n\t\tlet housesVariables = [...new Set(housesOfCity.map(x => x.house))]\r\n\t\tsetHouseOptions(housesVariables)\r\n\t\tsetStreetValue(street)\r\n\t\tsetHouseValue('')\r\n\t\tsetApartmentValue('')\r\n\t}\r\n\r\n\tconst toggleHouse = (house) => {\r\n\t\tlet apartmentsOfCity = data.filter(x => x.city === cityValue && x.street === streetValue && x.house === house)\r\n\t\tsetApartmentOptions(apartmentsOfCity)\r\n\t\tsetHouseValue(house)\r\n\t\tsetApartmentValue('')\r\n\t}\r\n\r\n\tconst toggleApartment = (item) => {\r\n\t\tconsole.log(item)\r\n\t\tsetModeSendBtn('send')\r\n\t\tsetApartmentValue(item.apartment)\r\n\t\tsetApartmentItem(item)\r\n\t\tsetActivePhoto(null) // mb\r\n\t\tif (autoCam)\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (photoRef.current) photoRef.current.click()\r\n\t\t\t}, 200);\r\n\r\n\t\tconsole.log(photoRef.current)\r\n\t\t// document.getElementById('btnPhoto').click()\r\n\t}\r\n\r\n\tconst sendValMeter = () => {\r\n\t\tconsole.log('sendValMeter')\r\n\t\tsetValMeterValue('')\r\n\t\tsetModeSendBtn('done')\r\n\t\tlet newData = []\r\n\t\tdata.forEach(element => {\r\n\t\t\tif (element.id === apartmentItem.id)\r\n\t\t\t\tnewData.push({ ...element, transferred: true })\r\n\t\t\telse newData.push({ ...element })\r\n\t\t});\r\n\t\tsetData(newData)\r\n\r\n\t\tlet apartmentsOfCity = newData.filter(x => x.city === cityValue && x.street === streetValue && x.house === houseValue)\r\n\t\tsetApartmentOptions(apartmentsOfCity)\r\n\t}\r\n\r\n\r\n\treturn <Panel id={id}>\r\n\t\t<Group>\r\n\t\t\t<CellButton onClick={() => router.pushModal(MODAL_DATABASE)}>Настройки</CellButton>\r\n\t\t\t<CellButton after={addssFields ? <Icon24ChevronUp /> : <Icon24ChevronDown />} onClick={() => setAddssFields(!addssFields)}>Локатор</CellButton>\r\n\t\t\t<AnimateHeight height={addssFields ? 'auto' : 0}>\r\n\t\t\t\t<FormItem top=\"Город\">\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tplaceholder=\"Выберите город\"\r\n\t\t\t\t\t\tsearchable='true'\r\n\t\t\t\t\t\toptions={cityOptions}\r\n\t\t\t\t\t\tvalue={cityValue}\r\n\t\t\t\t\t\tonChange={toggleCity}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</FormItem>\r\n\t\t\t\t{cityValue !== '' && <FormItem top=\"Улица\">\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tdisabled={cityValue === ''}\r\n\t\t\t\t\t\tplaceholder=\"Выберите улицу\"\r\n\t\t\t\t\t\tsearchable='true'\r\n\t\t\t\t\t\toptions={streetOptions}\r\n\t\t\t\t\t\tvalue={streetValue}\r\n\t\t\t\t\t\tonChange={toggleStreet}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</FormItem>}\r\n\t\t\t\t{streetValue !== '' && <FormItem top=\"Дом\">\r\n\t\t\t\t\t<HorizontalScroll\r\n\t\t\t\t\t\tshowArrows\r\n\t\t\t\t\t\tgetScrollToLeft={(i) => i - 120}\r\n\t\t\t\t\t\tgetScrollToRight={(i) => i + 120}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tabs mode=\"buttons\" style={{ display: \"flex\" }}>\r\n\t\t\t\t\t\t\t{houseOptions.map(item => <div className='mh4' key={item}>\r\n\t\t\t\t\t\t\t\t<TabsItem\r\n\t\t\t\t\t\t\t\t\tselected={item === houseValue}\r\n\t\t\t\t\t\t\t\t\tonClick={() => toggleHouse(item)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{item}\r\n\t\t\t\t\t\t\t\t</TabsItem>\r\n\t\t\t\t\t\t\t</div>)}\r\n\t\t\t\t\t\t</Tabs>\r\n\t\t\t\t\t</HorizontalScroll>\r\n\t\t\t\t</FormItem>}\r\n\t\t\t</AnimateHeight>\r\n\t\t\t{houseValue !== '' && <FormItem top=\"Квартира\">\r\n\t\t\t\t<HorizontalScroll\r\n\t\t\t\t\tshowArrows\r\n\t\t\t\t\tgetScrollToLeft={(i) => i - 120}\r\n\t\t\t\t\tgetScrollToRight={(i) => i + 120}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tabs mode=\"buttons\" style={{ display: \"flex\" }}>\r\n\t\t\t\t\t\t{apartmentOptions.filter(i => !i.transferred)\r\n\t\t\t\t\t\t\t.map(item => <div className='mh4' key={item.id}>\r\n\t\t\t\t\t\t\t\t<TabsItem\r\n\t\t\t\t\t\t\t\t\tselected={item.apartment === apartmentValue}\r\n\t\t\t\t\t\t\t\t\tonClick={() => toggleApartment(item)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{item.apartment}\r\n\t\t\t\t\t\t\t\t</TabsItem>\r\n\t\t\t\t\t\t\t</div>)}\r\n\t\t\t\t\t\t{apartmentOptions.filter(i => i.transferred)\r\n\t\t\t\t\t\t\t.map(item => <div className='mh4' key={item.id}>\r\n\t\t\t\t\t\t\t\t<TabsItem\r\n\t\t\t\t\t\t\t\t\tselected={item.apartment === apartmentValue}\r\n\t\t\t\t\t\t\t\t\tonClick={() => toggleApartment(item)}\r\n\t\t\t\t\t\t\t\t\tafter={<Icon12Verified style={{ color: \"var(--accent)\" }} />}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{item.apartment}\r\n\t\t\t\t\t\t\t\t</TabsItem>\r\n\t\t\t\t\t\t\t</div>)}\r\n\t\t\t\t\t\t{/* {apartmentOptions.map(item => <div className='mh4' key={item.id}>\r\n\t\t\t\t\t\t\t<TabsItem\r\n\t\t\t\t\t\t\t\tselected={item.apartment === apartmentValue}\r\n\t\t\t\t\t\t\t\tonClick={() => toggleApartment(item.apartment)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{i}\r\n\t\t\t\t\t\t\t</TabsItem>\r\n\t\t\t\t\t\t</div>)} */}\r\n\t\t\t\t\t</Tabs>\r\n\t\t\t\t</HorizontalScroll>\r\n\t\t\t</FormItem>}\r\n\r\n\t\t\t{/* <FormItem><FormStatus>1 вариант. Стандартная камера, чекбокс для автоматического открытия после выбора квартиры</FormStatus></FormItem> */}\r\n\r\n\t\t\t{/* <Div style={{ display: 'flex' }}>\r\n\r\n\t\t\t\t<File id='btnPhoto' before={<Icon24Camera />} controlSize=\"l\" stretched accept=\"image/*\" capture='camera' style={{ marginRight: 8 }} onChange={changeFile}>\r\n\t\t\t\t\tСделать фото\r\n\t\t\t\t</File>\r\n\t\t\t\t<Button className='btnText' before={<Icon24Camera />} size=\"l\" mode=\"secondary\" stretched disabled>Просмотр фото</Button>\r\n\t\t\t</Div> */}\r\n\r\n\t\t\t{apartmentValue !== \"\" && <Div>\r\n\t\t\t\t<File getRef={photoRef} id='btnPhoto' before={<Icon24Camera />} controlSize=\"l\" stretched accept=\"image/*\" capture='camera' onChange={changeFile}>\r\n\t\t\t\t\tСделать фото\r\n\t\t\t\t</File>\r\n\t\t\t</Div>}\r\n\r\n\t\t\t{/* {activePhoto && <Div>\r\n\t\t\t\t<Card>\r\n\t\t\t\t\t<div style={{\r\n\t\t\t\t\t\theight: 200,\r\n\t\t\t\t\t\tbackgroundImage: 'url(\"' + activePhoto + '\")',\r\n\t\t\t\t\t\tbackgroundSize: 'cover',\r\n\t\t\t\t\t\tbackgroundPosition: 'center',\r\n\t\t\t\t\t\tborderRadius: 8\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Card>\r\n\t\t\t</Div>} */}\r\n\t\t\t{/* <FormItem><FormStatus>2 вариант. Всегда открытая \"веб-камера\". Качество как на экране. </FormStatus></FormItem>\r\n\t\t\t<Webcam\r\n\t\t\t\tref={webcamRef}\r\n\t\t\t\tstyle={{ width: \"100%\" }}\r\n\t\t\t\taudio={false}\r\n\t\t\t\tscreenshotFormat=\"image/jpeg\"\r\n\t\t\t\tvideoConstraints={{\r\n\t\t\t\t\tfacingMode: \"environment\"\r\n\t\t\t\t}}\r\n\t\t\t\tscreenshotQuality={1}\r\n\t\t\t/>\r\n\t\t\t<Div>\r\n\t\t\t\t<Button before={<Icon24Camera />} size=\"l\" stretched onClick={capture}>Сделать фото</Button>\r\n\t\t\t</Div>\r\n\t\t\t{imgSrc && (\r\n\t\t\t\t<a href={imgSrc} target='_blank' rel=\"noopener noreferrer\">\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\tsrc={imgSrc}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</a>\r\n\t\t\t)} */}\r\n\r\n\t\t\t{/* <CropImg activePhoto={activePhoto} setActivePhotoCrop={setActivePhotoCrop} /> */}\r\n\r\n\r\n\t\t\t{apartmentValue !== \"\" && <Div style={{ display: 'flex' }}>\r\n\t\t\t\t<Input\r\n\t\t\t\t\t// autoFocus\r\n\t\t\t\t\tvalue={valMeterValue}\r\n\t\t\t\t\tonChange={(e) => setValMeterValue(e.target.value)}\r\n\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\tplaceholder='Введите показание'\r\n\t\t\t\t\tstyle={{ width: \"100%\", marginRight: 8 }}\r\n\t\t\t\t\tgetRef={valMeterRef}\r\n\t\t\t\t/>\r\n\t\t\t\t<Button disabled={valMeterValue.length === 0} onClick={sendValMeter} size='l'>Отправить</Button>\r\n\t\t\t\t{/* <WriteBarIcon mode={modeSendBtn} disabled={valMeterValue.length === 0} onClick={sendValMeter} /> */}\r\n\t\t\t</Div>}\r\n\r\n\t\t\t{/* <FormItem>\r\n\t\t\t\t<Button size='l' stretched>Отправить</Button>\r\n\t\t\t</FormItem> */}\r\n\t\t\t<FormItem>\r\n\t\t\t\t<Checkbox checked={autoCam} onChange={e => setAutoCam(e.target.checked)}>Автоматическое открытие камеры</Checkbox>\r\n\t\t\t\t{/* <Checkbox>Автоматический переход к следующей квартире</Checkbox> */}\r\n\t\t\t\t{/* <Checkbox checked={previewFields} onChange={e => setPreviewFields(e.target.checked)}>Предпросмотр фото</Checkbox> */}\r\n\t\t\t</FormItem>\r\n\r\n\t\t\t{apartmentValue !== \"\" && <><CellButton after={additionalFields ? <Icon24ChevronUp /> : <Icon24ChevronDown />} onClick={() => setAdditionalFields(!additionalFields)}>Дополнительные поля</CellButton>\r\n\t\t\t\t<AnimateHeight height={additionalFields ? 'auto' : 0}>\r\n\t\t\t\t\t<FormItem top='Тип ПУ'>\r\n\t\t\t\t\t\t<Input placeholder='Введите тип ПУ' />\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<FormItem top='Номер ПУ'>\r\n\t\t\t\t\t\t<Input placeholder='Введите номер ПУ' />\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<FormItem top=\"Год поверки\">\r\n\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\tplaceholder=\"Выберите год поверки\"\r\n\t\t\t\t\t\t\tsearchable='true'\r\n\t\t\t\t\t\t\toptions={[...Array(23).keys()].map(i => {\r\n\t\t\t\t\t\t\t\treturn { label: (2000 + i).toString(), value: (2000 + i).toString() }\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<FormItem top=\"Класс точности\">\r\n\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\tplaceholder=\"Выберите класс точности\"\r\n\t\t\t\t\t\t\tsearchable='true'\r\n\t\t\t\t\t\t\toptions={[{\r\n\t\t\t\t\t\t\t\tlabel: \"1.0\",\r\n\t\t\t\t\t\t\t\tvalue: \"1.0\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabel: \"2.0\",\r\n\t\t\t\t\t\t\t\tvalue: \"2.0\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabel: \"2.5\",\r\n\t\t\t\t\t\t\t\tvalue: \"2.5\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabel: \"5.0\",\r\n\t\t\t\t\t\t\t\tvalue: \"5.0\",\r\n\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<FormItem top=\"Значность\">\r\n\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\tplaceholder=\"Выберите значность\"\r\n\t\t\t\t\t\t\tsearchable='true'\r\n\t\t\t\t\t\t\toptions={[{\r\n\t\t\t\t\t\t\t\tlabel: \"1\",\r\n\t\t\t\t\t\t\t\tvalue: \"1\",\r\n\t\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\t\tlabel: \"4\",\r\n\t\t\t\t\t\t\t\tvalue: \"4\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabel: \"5\",\r\n\t\t\t\t\t\t\t\tvalue: \"5\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabel: \"6\",\r\n\t\t\t\t\t\t\t\tvalue: \"6\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlabel: \"7\",\r\n\t\t\t\t\t\t\t\tvalue: \"7\",\r\n\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\tafter={<Switch aria-label=\"Пломба поверки\" />}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tПломба поверки\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\tafter={<Switch aria-label=\"Пломба ЭСО\" />}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tПломба ЭСО\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t\t<Cell\r\n\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\tafter={<Switch aria-label=\"Антимагнитная\" />}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tАнтимагнитная\r\n\t\t\t\t\t</Cell>\r\n\t\t\t\t\t<FormItem top='Дата'>\r\n\t\t\t\t\t\t<Input placeholder='Введите дату' value={new Date().toLocaleDateString('ru-RU')} onChange={() => { }} />\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<FormItem top='Место установки'>\r\n\t\t\t\t\t\t<Input placeholder='Введите место установки' />\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t\t<FormItem top='Примечание'>\r\n\t\t\t\t\t\t<Input placeholder='Введите примечание' />\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</AnimateHeight>\r\n\t\t\t</>}\r\n\t\t</Group>\r\n\t</Panel >\r\n}\r\n\r\nexport default Home;\r\n","const API_URL = 'https://cu56702.tmweb.ru/api/'\r\n\r\nexport const getOrders = async (data) => {\r\n    return fetch(API_URL + 'orders/', {\r\n        method: \"POST\",\r\n        body: JSON.stringify({\r\n            ...data,\r\n            \"jwt\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL2N1NTY3MDIudG13ZWIucnUiLCJhdWQiOiJodHRwczovL2N1NTY3MDIudG13ZWIucnUiLCJpYXQiOjE2NDcyNzYzMzAsIm5iZiI6MTY0NzM3MTEwNSwiZGF0YSI6eyJpZCI6IjYiLCJlbWFpbCI6InZhc3lhQGNvZGVyLmNvbSJ9fQ.UjeSOi1EPAylN3bA7YyrLUG3LhQ_Duk88C1m0HQVLns\"\r\n        }),\r\n    })\r\n        .then(res => res.json())\r\n        .then(res => res)\r\n        .catch(e => { return { status: 'error', message: 'Network error' } })\r\n}","import React, { useState } from 'react';\r\nimport { Panel, PanelHeader, Button, Group, FormItem, Input, Div, FormLayout } from '@vkontakte/vkui';\r\nimport * as api from '../api/api';\r\nimport { useRouter } from '@happysanta/router';\r\nimport { MODAL_ERROR, PAGE_MAIN } from '../routers';\r\n\r\nconst Auth = ({ id, setModalErrorText }) => {\r\n\tconst [login, setLogin] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\r\n\tconst router = useRouter();\r\n\r\n\t// const onLogin = async () => {\r\n\t// \tconst auth_data = await api.onLogin({ login, password })\r\n\t// \tif (auth_data.message) {\r\n\t// \t\tsetModalErrorText(auth_data.message)\r\n\t// \t\trouter.pushModal(MODAL_ERROR)\r\n\t// \t} else {\r\n\t// \t\tlocalStorage.setItem('token', auth_data.token)\r\n\t// \t\tlocalStorage.setItem('u_hash', auth_data.u_hash)\r\n\t// \t\trouter.replacePage(PAGE_MAIN)\r\n\t// \t}\r\n\t// }\r\n\treturn <Panel id={id}>\r\n\t\t<PanelHeader>Авторизация</PanelHeader>\r\n\t\t<Group>\r\n\t\t\t<FormLayout>\r\n\t\t\t\t<FormItem top='Логин'>\r\n\t\t\t\t\t<Input placeholder='Введите логин' value={login} onChange={(e) => setLogin(e.target.value)} />\r\n\t\t\t\t</FormItem>\r\n\t\t\t\t<FormItem top='Пароль'>\r\n\t\t\t\t\t<Input placeholder='Введите пароль' type='password' value={password} onChange={(e) => setPassword(e.target.value)} />\r\n\t\t\t\t</FormItem>\r\n\t\t\t\t<Div>\r\n\t\t\t\t\t<Button type='submit' stretched size='l' /* onClick={onLogin} */ disabled={login.length === 0 || password.length === 0}>Войти</Button>\r\n\t\t\t\t</Div>\r\n\t\t\t</FormLayout>\r\n\t\t</Group>\r\n\t</Panel>\r\n}\r\n\r\nexport default Auth;\r\n","import { ModalCard } from '@vkontakte/vkui';\r\nimport React from 'react';\r\nimport { useRouter } from '@happysanta/router';\r\n\r\nexport function CardError({ id, modalErrorText }) {\r\n\tconst router = useRouter();\r\n\treturn <ModalCard\r\n\t\tid={id}\r\n\t\tonClose={() => router.popPage()}\r\n\t\theader=\"Error\"\r\n\t\tsubheader={modalErrorText}\r\n\t/>;\r\n}\r\n","import { Button, ModalCard, Spacing, Spinner } from '@vkontakte/vkui';\r\nimport React from 'react';\r\nimport { useRouter } from '@happysanta/router';\r\nimport { Icon56SettingsOutline } from '@vkontakte/icons';\r\n\r\nexport function CardDatabase({ id, countDownload, waitDownload, loadOrders }) {\r\n\tconst router = useRouter();\r\n\treturn <ModalCard\r\n\t\tid={id}\r\n\t\ticon={waitDownload ? <Spinner size=\"large\" style={{ margin: \"6px 0\" }} /> : <Icon56SettingsOutline />}\r\n\t\tonClose={() => router.popPage()}\r\n\t\theader=\"Настройки\"\r\n\t\tsubheader={<>\r\n\t\t\t<p>Загружено {countDownload} адресов</p>\r\n\t\t\t<p>Пройдено 0 адресов</p>\r\n\t\t</>}\r\n\t>\r\n\t\t<Spacing />\r\n\t\t<Button\r\n\t\t\tsize=\"l\"\r\n\t\t\tonClick={loadOrders}\r\n\t\t\tdisabled={waitDownload}\r\n\t\t>\r\n\t\t\tОбновить данные\r\n\t\t</Button>\r\n\t</ModalCard>;\r\n}\r\n","import '@vkontakte/vkui/dist/vkui.css';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ModalRoot, SplitLayout, SplitCol, View, AdaptivityProvider, AppRoot, ConfigProvider, WebviewType, ScreenSpinner } from '@vkontakte/vkui';\r\nimport Home from './panels/Home';\r\nimport { MODAL_DATABASE, MODAL_ERROR, PAGE_AUTH, PANEL_AUTH, PANEL_MAIN, VIEW_MAIN } from './routers';\r\nimport { useLocation, useRouter } from '@happysanta/router';\r\nimport './panels/style.css'\r\nimport Auth from './panels/Auth';\r\nimport { CardError } from './modals/CardError';\r\nimport { CardDatabase } from './modals/CardDatabase';\r\nimport { getOrders } from './api/api';\r\nfunction App() {\r\n\tconst location = useLocation();\r\n\tconst router = useRouter();\r\n\r\n\tconst [popout, setPopout] = React.useState(null);\r\n\tconst [dataOrders, setDataOrders] = useState([])\r\n\tconst [modalErrorText, setModalErrorText] = useState('')\r\n\tconst [countDownload, setCountDownload] = useState(0)\r\n\tconst [waitDownload, setWaitDownload] = useState(false)\r\n\r\n\r\n\r\n\t// useEffect(() => {\r\n\t// \tif (!localStorage.getItem('token') && !localStorage.getItem('u_hash')) {\r\n\t// \t\trouter.replacePage(PAGE_AUTH)\r\n\t// \t}\r\n\t// }, [router]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetPopout(<ScreenSpinner />)\r\n\t\tloadCachesData()\r\n\t}, [])\r\n\r\n\tconst loadOrders = async () => {\r\n\t\tsetWaitDownload(true)\r\n\t\tlet data = []\r\n\t\tlet hasData = true\r\n\t\tlet offset = 0\r\n\t\twhile (hasData) {\r\n\t\t\tlet orders = await getOrders({ offset, count: 10000 })\r\n\t\t\tif (orders.status === 'ok' && orders.data.length > 0) {\r\n\t\t\t\tdata = [...data, ...orders.data]\r\n\t\t\t\toffset += orders.data.length\r\n\t\t\t\tsetCountDownload(offset)\r\n\t\t\t} else {\r\n\t\t\t\thasData = false\r\n\t\t\t}\r\n\t\t\thasData = false\r\n\t\t}\r\n\t\tconst jsonResponse = new Response(JSON.stringify(data), {\r\n\t\t\theaders: {\r\n\t\t\t\t'content-type': 'application/json'\r\n\t\t\t}\r\n\t\t});\r\n\t\tcaches.open('orders').then(cache => cache.put('/data.json', jsonResponse));\r\n\t\tsetWaitDownload(false)\r\n\t\tsetDataOrders(data)\r\n\t}\r\n\r\n\tconst loadCachesData = async () => {\r\n\t\tlet data = await caches.match('/data.json').then(r => {\r\n\t\t\tif (r) return r.json()\r\n\t\t\telse return []\r\n\t\t}).then(r => r)\r\n\t\tconsole.log(data)\r\n\t\tsetDataOrders(data)\r\n\t\tsetCountDownload(data.length || 0)\r\n\t\tsetPopout(null)\r\n\t}\r\n\r\n\tconst modal = <ModalRoot activeModal={location.getModalId()}\r\n\t\tonClose={() => router.popPage()}\r\n\t>\r\n\t\t<CardError id={MODAL_ERROR} onClose={() => router.popPage()} modalErrorText={modalErrorText} />\r\n\t\t<CardDatabase id={MODAL_DATABASE} onClose={() => router.popPage()} countDownload={countDownload} waitDownload={waitDownload} loadOrders={loadOrders} />\r\n\t</ModalRoot>;\r\n\r\n\treturn <ConfigProvider webviewType={WebviewType.INTERNAL}>\r\n\t\t<AdaptivityProvider>\r\n\t\t\t<AppRoot>\r\n\t\t\t\t<SplitLayout modal={modal} popout={popout} style={{ justifyContent: \"center\" }}>\r\n\t\t\t\t\t<SplitCol maxWidth={800} spaced={window.innerWidth > 800}>\r\n\t\t\t\t\t\t<View id={VIEW_MAIN}\r\n\t\t\t\t\t\t\tonSwipeBack={() => router.popPage()}\r\n\t\t\t\t\t\t\thistory={location.hasOverlay() ? [] : location.getViewHistory(VIEW_MAIN)}\r\n\t\t\t\t\t\t\tactivePanel={location.getViewActivePanel(VIEW_MAIN)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Home id={PANEL_MAIN} dataOrders={dataOrders} />\r\n\t\t\t\t\t\t\t<Auth id={PANEL_AUTH} setModalErrorText={setModalErrorText} />\r\n\t\t\t\t\t\t</View>\r\n\r\n\t\t\t\t\t</SplitCol>\r\n\t\t\t\t</SplitLayout>\r\n\t\t\t</AppRoot>\r\n\t\t</AdaptivityProvider>\r\n\t</ConfigProvider>\r\n\r\n}\r\n\r\nexport default App;\r\n\r\n\r\n","import 'core-js/features/map';\r\nimport 'core-js/features/set';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport { RouterContext } from '@happysanta/router';\r\nimport { router } from './routers';\r\n\r\nReactDOM.render(<RouterContext.Provider value={router}>\r\n\t<App />\r\n</RouterContext.Provider>, document.getElementById('root'));\r\n\r\n"],"sourceRoot":""}